# Лаб 03. PHP ба MySQL
Энэ лабораторийн ажлаар MySQL өгөгдлийн сангийн холболт үүсгэх, MySQLi өргөтгөл ашиглах, өгөгдлийн сангаас өгөгдөл гаргах асуулга ажиллуулах, үр дүн боловсруулах, сервер талд бэлтгэх, түүнийг сервер талд түр хадгалах, DDL командууд ажиллуулах, өгөгдөл оруулах, устгах, SQL тарилгаас сэргийлэх зэрэг чадварыг эзэмших зорилготой.

## Дасгал 1.	
[1] номын 10-р бүлгийн бүх PHP кодыг дуурайн бичиж дасгал хийнэ. Үүнд:
1.	PhpMyAdmin вэб програмыг ашиглан books нэртэй дараах 5 талбартай хүснэгтийг үүсгэнэ.
Зохиогч (author)
Гарчиг (title)
Ангилал (Category)
Он (Year)
ISBN дугаар (ISBN)
2.	Хичээлдээ ашиглаж байсан 5 номын мэдээллийг SQL хэлний INSERT INTO командаар phpMyAdmin вэб програмын асуулга ажиллуулах интерфейсээр оруулна. 
3.	Номын 241-268-р хуудас хүртэлх бүх кодыг бичиж ажиллуулна.
4.	10-р бүлгийн бүх асуултад хариулна.

## Даалгавар 1.	
Оюутны хичээл сонголтын өгөгдөлтэй ажиллах вэб хуудасны PHP програмыг хөгжүүлнэ. Үүнд өөрийн ашиглаж буй PHP хэлний хувилбараас хамаарч mysqli_* эсвэл хуучирсан mysql_* функцийг ашиглана.

1.	Вэб програмыг суулгаж бэлтгэхэд өгөгдлийн сангаа өөрөө үүсгэдэг скрипт бичиж болдог. Өөрөөр хэлбэл, вэб програм суулгах үед хэрэглэгчээс өгөгдлийн санд хандах эрхийг асууж аваад (эсвэл тохиргооны файлаас уншиж) хүснэгт үүсгэх, үүссэн хүснэгтэд PK (Primary key), FK (Foreign key) хориглолтыг нэмж тодорхойлох, туршилтын өгөгдөл оруулах зэрэг үйлдлийг хийж болох юм. Ийм скриптийг вэб програмыг суулгах үед нэг удаа ажиллуулаад дараа устгадаг байхаар програмчилж болно.

Дараах шаардлагын дагуу холбоост өгөгдлийн сан (Relational Database) үүсгэх DDL командыг ажиллуулж туршилтын өгөгдөл оруулах PHP скрипт бичнэ.
* Оюутны овог, нэр, хувийн дугаар, хүйс, төрсөн огноо, нууц үг зэрэг мэдээллийг хадгалах *оюутны мэдээлэл* нэртэй хүснэгт үүсгэнэ. 
* *Мэргэжлийн хөтөлбөр* гэсэн хүснэгтэд хөтөлбөрийн нэр, хөтөлбөрийн батлагдсан огноо зэрэг мэдээллийг хадгална. 
* Нэг оюутан нэг мэргэжлийн хөтөлбөрөөр суралцдаг бөгөөд үүнийг *оюутны мэдээлэл* хадгалах хүснэгтэнд хадгална. 
* Оюутны сонгосон хичээлүүдийг хадгалах хүснэгт байх бөгөөд тэр хүснэгтэд нэг хичээлийг олон оюутан сонгож болно, нэг оюутан олон хичээл сонгож болно гэх логикийг агуулдаг байна. 
* Хичээл бүр хичээлийн нэр, индекс, багц цаг зэрэг 3 талбартай байна.  
* 5 оюутны өгөгдлийг бэлтгэж INSERT INTO командаар дараалуулан оруулна. Оюутны өгөгдлийг скриптэд тогтмол утгаар өгч болно.
> Хүснэгт хооронд үүсэх FK хориглолтыг PK агуулах хүснэгтээ үүсгэсний дараа ALTER TABLE командаар үүсгэдгийг (https://www.w3schools.com/sql/sql_foreignkey.asp) санаарай.

2.	Оюутны мэдээллийг хүснэгтээр харуулах list.php нэртэй вэб хуудас хөгжүүлнэ. Энэ хуудас нэг оюутны мэдээллийг нэг мөрөнд үзүүлдэг байна. Мөрийн ард устгах, засах товчлуурууд (эсвэл линк/холбоос) байна. Эдгээр холбоосыг <a> элемент ашиглан хийж болох бөгөөд линкийг дарахад delete.php?s_id=[student_id] querystring-ийг GET аргаар дамжуулдаг байж болно. Засах холбоосыг дарахад оюутны мэдээллийг HTML маягтын тохирох элементүүдэд гарааны утга болгон оруулж доор нь засах товч байх ба энэ товчийг дарахад өгөгдлийн санд мэдээллийг засварлана. Үүнийг update.php хуудас үүсгэж хийнэ. Хүснэгтийн дээд талд нэмэх товч байх бөгөөд оюутны мэдээллийг шинээр оруулдаг байна. Үүнийг insert.php хуудас үүсгэж хийнэ. Үүнд оюутны мэдээллийг харуулах list.php нь procedural MySQLi аргаар хөгжүүлэгдсэн кодтой байна.

3. Оюутнууд өөрийн үзэхийг хүссэн хичээлүүдээ сонгох, сонгосон хичээлүүдээ устгах боломжоор хангагдахад зориулж нэвтрэх хуудас хөгжүүлэх бөгөөд оюутан хүснэгтийн хувийн дугаар болон нууц үгийг амжилттай оруулж хичээлийн жагсаалт бүхий хуудасруу орно. Хэрэглэгчийн нэр нууц үг шалгахдаа SQL Injection халдлагын аргаар халдаж нэвтэрч, мөн өөр ямар нэгэн аргаар өгөгдлийн санд байгаа өгөгдлийг өөрчилж үзнэ. Дараа нь SQL Injection халдлагаас сэргийлэх кодыг хөгжүүлж буй програмдаа нэмж оруулна. Үүнийг дараах 2 аргаар тус тусад нь гүйцэтгэнэ.
a.	GET, POST параметрээр ирсэн утгыг цэвэрлэх (sanitize)
b.	Параметртэй асуулга ажиллуулах (placeholder)

4.	Оюутан өөрийн мэдээллээр нэвтрэн орсон бол нийт хичээлүүдийн жагсаалт бүхий хүснэгт харагдах бөгөөд оюутан аль хэдий нь сонгосон хичээлүүд нь ногоон өнгөтэй мөн ард нь байрлах checkbox сонгогдсон, сонгоогүй бол өнгөгүй checkbox нь сонгогдоогүй харагдана.

5. Сонгоогүй хичээлүүдийн ард сонгох checkbox байх бөгөөд үзэхийг хүссэн хичээлүүдээ сонгоод хадгалах товч дарсанаар уг мэдээллүүд өгөгдлийн санд хадгалагдана. Энэхүү үйлдлийг PDO аргачлалаар бичсэн кодтой байдлаар шалгана.

> MySQLi object oriented, procedural, PDO аргуудын ялгааг энэхүү жишээн дээр үзүүлсэн кодуудаас харна уу. https://www.w3schools.com/Php/php_mysql_select.asp

## Ном зүй
[1] Robin Nixon, Learning PHP, MySQL, JavaScript, CSS & HTML5, 3rd Edition, 2014, 729 pages, ISBN: 978-1-491-94946-7
